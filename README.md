# 湖南大学校园网登录脚本

> 一个用于校园网环境下自动登录、切换与断开的 Shell 脚本工具，支持内网登录与电信宽带出口切换，登录后推送IP地址到Sever酱，用于远程控制。

---

## 文件结构说明

当前项目包含以下文件：

| 文件名         | 作用说明                  |
| ----------- | --------------------- |
| `dl`        | 校园网**内网登录脚本**（登录校园内网） |
| `dx`        | **电信宽带登录脚本**（出口为电信认证） |
| `dk`        | **断开当前登录**（登出/解绑）     |
| `switch.sh` | 登录方式切换控制脚本            |
| `*.signal`  | 当前登录方式的**状态标志文件**     |
| `log.log`   | 所有操作日志文件              |

---

## 工作机制说明

本项目采用**信号文件 + 脚本控制**的方式维护网络状态：

* `dl.signal`：当前为 **内网登录状态**
* `dx.signal`：当前为 **电信宽带登录状态**
* 无 signal 文件：表示未登录或断开状态

各脚本之间通过 `.signal` 文件进行状态同步，避免重复登录或冲突操作。

---

## 使用说明

### 配置账号信息

分别编辑 `dl`、`dx`、`dk` 中的配置段：

```sh
RAW_USER_ACCOUNT=""
USER_PASSWORD=""
SERVERCHAN_KEY=""
```

说明：

* `RAW_USER_ACCOUNT`：原始账号，即学号
* `USER_PASSWORD`：密码明文
* `SERVERCHAN_KEY`：Server酱通知 key（可留空）

---

### 执行登录 / 切换

#### 登录校园内网

```sh
./dl
```

#### 登录电信宽带

```sh
./dx
```

#### 断开当前连接

```sh
./dk
```

#### 自动切换登录方式

```sh
./switch.sh
```

> `switch.sh` 会根据当前 `.signal` 文件状态，在内网与电信之间自动切换。

---

##  日志说明

所有脚本运行日志统一记录到：

```
log.log
```

---

##  依赖说明

推荐环境：

* Linux / OpenWrt / 路由器 / 服务器
* Shell: `sh` / `bash`
* 工具依赖：

  * `curl`
  * `ip` 或 `ifconfig`
  * `jq`（可选，用于Sever酱编码）

---

##  Server酱推送通知说明（可选）

本项目支持通过 **Server酱（ServerChan）** 在登录成功或失败时向微信推送通知，便于远程设备或无人值守环境中实时掌握网络状态。

### 一、支持的推送场景

当你在脚本中配置了 `SERVERCHAN_KEY` 后，将触发如下通知：

*  登录成功通知
*  登录失败/异常通知（如接口错误、无法获取 IP 等）
*  登录方式切换通知（如内网 ↔ 电信）

> 若 `SERVERCHAN_KEY` 留空，则不会发送任何推送，不影响脚本正常运行。

---

### 二、如何配置 Server酱

1. 前往官网获取 Key
    [https://sct.ftqq.com/](https://sct.ftqq.com/)

2. 在脚本配置区填写：

```sh
SERVERCHAN_KEY="你的Key"
```

示例：

```sh
SERVERCHAN_KEY="SCT123456abcdef"
```

---

### 三、推送内容示例

#### 登录成功

```
标题：电信登录成功
内容：
IP: 10.123.45.67
```

#### 登录失败

```
标题：校园网登录失败
内容：
IP: 10.123.45.67
错误信息: 用户名或密码错误
时间: 2026-01-20 16:40:12
```

---

## License

本项目仅供学习与交流使用，请遵守所在学校网络使用规范。
因使用本脚本造成的任何问题，作者不承担相关责任。
